<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Dinner Wheel</title>

<style>

body{
margin:0;
background:radial-gradient(circle,#140028,#000);
color:white;
font-family:-apple-system,BlinkMacSystemFont,system-ui;
text-align:center;
}

h1{
margin:12px 0 6px;
font-size:clamp(26px,7vw,40px);
text-shadow:0 0 12px #ff00ff,0 0 22px #00eaff;
}

#wheel{
width:96vw;
max-width:520px;
display:block;
margin:8px auto;
border-radius:50%;
box-shadow:0 0 20px #ff00ff,0 0 70px #00eaff;
}

button{
width:92vw;
max-width:420px;
font-size:clamp(22px,6vw,30px);
padding:18px;
border:none;
border-radius:18px;
font-weight:900;
background:linear-gradient(45deg,#ff00ff,#00eaff);
color:black;
margin:10px 0 6px;
}

#winner{
font-size:clamp(28px,7vw,46px);
margin:14px;
font-weight:900;
opacity:0;
}

.flash{
animation:flash .6s infinite alternate;
}

@keyframes flash{
from{text-shadow:0 0 10px white,0 0 30px #ff00ff}
to{text-shadow:0 0 25px white,0 0 70px #00eaff}
}

/* confetti */
.confetti{
position:fixed;
width:8px;height:8px;
top:-10px;
pointer-events:none;
animation:fall linear forwards;
}

@keyframes fall{
to{transform:translateY(110vh) rotate(720deg);}
}

</style>
</head>

<body>

<h1>üçî DINNER DECIDER üçï</h1>

<button onclick="spin()">SPIN</button>

<canvas id="wheel" width="600" height="600"></canvas>

<div id="winner"></div>

<script>

const options=[
"Rocas Charleston",
"KC Buffet",
"Kita",
"Pies",
"Qdoba",
"IHOP KC",
"Crapplebee‚Äôs",
"Black Sheep",
"Slob Evans"
];

const colors=[
"#ff00ff","#00eaff","#ff2a6d",
"#00ffa6","#ffd400","#9d6bff",
"#00d4ff","#ff7a00","#39ff14"
];

const canvas=document.getElementById("wheel");
const ctx=canvas.getContext("2d");
const r=canvas.width/2;

let angle=0;
let spinning=false;

function draw(){

ctx.clearRect(0,0,canvas.width,canvas.height);

const slice=2*Math.PI/options.length;

// dynamic font size for iPhone
const fontSize=Math.max(14,Math.min(22,520/options.length));

options.forEach((o,i)=>{

ctx.beginPath();
ctx.moveTo(r,r);
ctx.arc(r,r,r-5,i*slice+angle,(i+1)*slice+angle);
ctx.fillStyle=colors[i%colors.length];
ctx.fill();

ctx.save();
ctx.translate(r,r);
ctx.rotate(i*slice+slice/2+angle);

ctx.fillStyle="white";
ctx.font="bold "+fontSize+"px system-ui";
ctx.textAlign="right";
ctx.fillText(o,r-28,6);

ctx.restore();

});

// RIGHT POINTER
ctx.fillStyle="white";
ctx.beginPath();
ctx.moveTo(canvas.width-6,r);
ctx.lineTo(canvas.width-46,r-22);
ctx.lineTo(canvas.width-46,r+22);
ctx.fill();

}

draw();

// tick sound
function tick(){
const a=new(window.AudioContext||window.webkitAudioContext)();
const o=a.createOscillator();
const g=a.createGain();
o.connect(g);g.connect(a.destination);
o.frequency.value=600+Math.random()*200;
o.start();
g.gain.setValueAtTime(.08,a.currentTime);
g.gain.exponentialRampToValueAtTime(.0001,a.currentTime+.04);
o.stop(a.currentTime+.04);
}

// confetti
function confetti(){
for(let i=0;i<100;i++){
let c=document.createElement("div");
c.className="confetti";
c.style.left=Math.random()*100+"vw";
c.style.background=colors[Math.floor(Math.random()*colors.length)];
c.style.animationDuration=(Math.random()*2+2)+"s";
document.body.appendChild(c);
setTimeout(()=>c.remove(),4000);
}
}

// voice
function announce(text){
let msg=new SpeechSynthesisUtterance("Dinner choice is "+text);
msg.rate=.95;
msg.pitch=1.1;
speechSynthesis.speak(msg);
}

function spin(){

if(spinning) return;
spinning=true;
document.getElementById("winner").style.opacity=0;

let velocity=Math.random()*0.55+0.45;

function frame(){

angle+=velocity;
velocity*=0.987;

if(Math.random()<0.35) tick();

draw();

if(velocity>0.002){
requestAnimationFrame(frame);
}else{

spinning=false;

const slice=2*Math.PI/options.length;

// EXACT RIGHT POINTER MATCH
let pointer=(0-angle)%(2*Math.PI);
if(pointer<0) pointer+=2*Math.PI;

let index=Math.floor(pointer/slice)%options.length;
let result=options[index];

if(navigator.vibrate) navigator.vibrate([200,100,200]);

confetti();
announce(result);

const w=document.getElementById("winner");
w.innerHTML="üçΩÔ∏è "+result.toUpperCase()+" üçΩÔ∏è";
w.style.opacity=1;
w.classList.add("flash");

}

}

frame();
}

</script>

</body>
</html>
